!function(u){"use strict";u(document).ready(function(){jQuery().niceSelect&&u(".youzify select").not('[multiple="multiple"]').niceSelect(),u(document).on("click",".youzify-upload-photo",function(o){o.preventDefault();o=u(this).closest(".youzify-uploader-item");o.find(".youzify_upload_file").attr("data-source",u("input[name=youzify_widget_source]").val()),o.find(".youzify_upload_file").attr("data-user-id",u("input[name=youzify_widget_user_id]").val()),o.find(".youzify_upload_file").trigger("click")}),u(document).on("change",".youzify_upload_file",function(o){o.stopPropagation();var o=new FormData,e=u(this),i=u(this).closest(".youzify-uploader-item"),t=i.find(".youzify-photo-preview"),a=i.find(".youzify-photo-url").val();o.append("nonce",u(this).closest("form").find("input[name='security']").val()),o.append("file",u(this)[0].files[0]),o.append("user_id",u(this).attr("data-user-id")),o.append("source",u(this).attr("data-source")),o.append("action","upload_files"),u.ajax({url:Youzify.ajax_url,type:"POST",data:o,contentType:!1,cache:!1,processData:!1,beforeSend:function(){u('<div class="youzify-load-photo"><i class="fas fa-spinner fa-spin"></i></div>').hide().appendTo(t).fadeIn(800)},success:function(o){e.val(""),0==o.success?(t.find(".youzify-load-photo").fadeOut(300).remove(),u.youzify_DialogMsg("error",o.data.error)):(a&&u.youzify_DeletePhoto(a),t.find(".youzify-load-photo").fadeOut(300,function(){u(this).remove(),t.fadeOut(100,function(){u(this).css("background-image","url("+o.data.url+")").fadeIn(400),i.find(".youzify-photo-url").val(o.data.attachment_id).change(),i.find(".youzify-delete-photo").addClass("youzify-show-trash"),u.post(Youzify.ajax_url,i.closest("form").serialize()+"&die=true")})}))}})}),u(".youzify-account-menu").on("click",function(o){var e=u(this).next(".youzify-account-menus");e.hasClass("youzify-show-account-menus")&&e.removeClass("youzify-show-account-menus").css("display","block"),u(this).next(".youzify-account-menus").slideToggle()}),u(document).on("click",".youzify-delete-photo",function(o){var e=u(this).closest(".youzify-uploader-item");u.youzify_DeletePhoto(e.find(".youzify-photo-url").val()),e.find(".youzify-photo-url").val("").trigger("change"),e.find(".youzify-photo-preview").css("background-image","url("+Youzify_Account.default_img+")"),u(this).removeClass("youzify-show-trash"),u.post(Youzify.ajax_url,e.closest("form").serialize()+"&die=true")}),u.youzify_DeletePhoto=function(o){var e=new FormData;e.append("attachment_id",o),e.append("action","youzify_delete_attachment"),u.ajax({type:"POST",data:e,url:Youzify.ajax_url,contentType:!1,processData:!1})},u(".youzify-account-photo .youzify-photo-url").on("change",function(o){o.preventDefault();var e=(e=u(this).val())||Youzify_Account.default_img;u(".youzify-account-img").fadeOut(200,function(){u(this).css("background-image","url("+e+")").fadeIn(200)})}),u(".youzify-user-provider-unlink").on("click",function(o){if(o.preventDefault(),u(this).hasClass("loading"))return!1;var e=u(this).closest(".youzify-user-provider-connected"),t=u(this),o=(t.addClass("loading"),{action:"youzify_unlink_provider_account",provider:u(this).data("provider"),security:u(this).data("nonce"),user_id:t.attr("data-user_id")});u.post(ajaxurl,o,function(o){o=u.parseJSON(o);return o.error?(t.removeClass("loading"),u.youzify_DialogMsg("error",o.error),!1):o.action?(t.removeClass("loading"),e.find(".youzify-user-provider-token").val(""),e.find(".youzify-user-provider-box").remove(),e.removeClass().addClass("youzify-user-provider-unconnected"),u.youzify_DialogMsg("success",o.msg),!1):void 0}).fail(function(o,e,i){return t.removeClass("loading"),u.youzify_DialogMsg("error",Youzify.unknown_error),!1})})})}(jQuery);